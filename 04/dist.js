function main(t,n){function o(t){var n=d3.scaleLinear().domain([0,1]).range([.4,1]);return function(o){var i=d3.rgb(t(n(o)));return[i.r/255,i.g/255,i.b/255]}}function i(t){var o=n({frag:"\n\t\t  precision highp float;\n\t\t\tvarying vec3 fragColor;\n\t\t\tvoid main() {\n\t\t\t\tgl_FragColor = vec4(fragColor, 1);\n\t\t\t}\n\t\t\t",vert:"\n\t\t\tattribute vec2 positionStart;\n\t\t\tattribute vec2 positionEnd;\n\t\t\tattribute float index;\n\t\t\tattribute vec3 colorStart;\n\t\t\tattribute vec3 colorEnd;\n\n\t\t\tvarying vec3 fragColor;\n\n\t\t\tuniform float pointWidth;\n\t\t\tuniform float stageWidth;\n\t\t\tuniform float stageHeight;\n\t\t\tuniform float elapsed;\n\t\t\tuniform float duration;\n\t\t\tuniform float delayByIndex;\n\t\t\tvoid main() {\n\t\t\t\tgl_PointSize = pointWidth;\n\n\t\t\t\tfloat delay = delayByIndex * index;\n\t      float t;\n\n\t      // drawing without animation, so show end state immediately\n\t      if (duration == 0.0) {\n\t        t = 1.0;\n\n\t      // still delaying before animating\n\t      } else if (elapsed < delay) {\n\t        t = 0.0;\n\t      } else {\n\t        t = 2.0 * ((elapsed - delay) / duration);\n\n\t        // cubic easing (cubicInOut) -- note there are glslify things for this toPhyllotaxis\n\t        // this is copied from d3.\n\t        t = (t <= 1.0 ? t * t * t : (t -= 2.0) * t * t + 2.0) / 2.0;\n\n\t        if (t > 1.0) {\n\t          t = 1.0;\n\t        }\n\t      }\n\n\t\t\t\t// interpolate position\n\t      float x = mix(positionStart[0], positionEnd[0], t);\n\t      float y = mix(positionStart[1], positionEnd[1], t);\n\n\t      // interpolate color\n\t      fragColor = mix(colorStart, colorEnd, t);\n\n\t\t\t\t// scale to normalized device coordinates (-1, -1) to (1, 1)\n\t      gl_Position = vec4(\n\t\t      2.0 * ((x / stageWidth) - 0.5),\n\t\t      // invert y since we think [0,0] is bottom left in pixel space (needed for d3.zoom)\n\t\t      -(2.0 * ((y / stageHeight) - 0.5)),\n\t\t      0.0,\n\t\t      1.0);\n\t\t\t}\n\t\t\t",attributes:{positionStart:t.map(function(t){return[t.sx,t.sy]}),positionEnd:t.map(function(t){return[t.tx,t.ty]}),colorStart:t.map(function(t){return t.colorStart}),colorEnd:t.map(function(t){return t.colorEnd}),index:d3.range(t.length)},uniforms:{pointWidth:n.prop("pointWidth"),stageWidth:n.prop("stageWidth"),stageHeight:n.prop("stageHeight"),delayByIndex:n.prop("delayByIndex"),duration:n.prop("duration"),elapsed:function(t,n){var o=t.time,i=n.startTime;return void 0===i&&(i=0),1e3*(o-i)}},count:t.length,primitive:"points"});return o}function e(t,o){console.log("animating with new layout"),o.forEach(function(t){t.sx=t.tx,t.sy=t.ty,t.colorStart=t.colorEnd}),t(o);var r=S[b];o.forEach(function(t,n){t.tx=t.x,t.ty=t.y,t.colorEnd=r(n/o.length)});var d=i(o);a=n.frame(function(t){var i=t.time;null===E&&(E=i),n.clear({color:[0,0,0,1],depth:1}),d({pointWidth:l,stageWidth:u,stageHeight:s,duration:c,delayByIndex:f,startTime:E}),i-E>g/1e3&&(console.log("done animating, moving to next layout"),a.cancel(),x=(x+1)%v.length,E=null,b=(b+1)%S.length,e(v[x],o))})}var a,r=1e5,l=4,d=1,u=window.innerWidth,s=window.innerHeight,c=1500,f=500/r,g=c+f*r,p=function(t){return phyllotaxisLayout(t,l+d,u/2,s/2)},h=function(t){return gridLayout(t,l+d,u)},m=function(t){return sineLayout(t,l+d,u,s)},y=function(t){return spiralLayout(t,l+d,u,s)},v=[p,h,m,y],x=0,E=null,S=[d3.scaleSequential(d3.interpolateViridis),d3.scaleSequential(d3.interpolateMagma),d3.scaleSequential(d3.interpolateInferno),d3.scaleSequential(d3.interpolateCool)].map(o),b=0,w=createPoints(r,l,u,s);window.points=w,w.forEach(function(t,n){t.tx=u/2,t.ty=s/2,t.colorEnd=S[b](n/w.length)}),e(v[x],w)}regl({extensions:["OES_texture_float"],onDone:main});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbInNjcmlwdC5qcyJdLCJuYW1lcyI6WyJtYWluIiwiZXJyIiwicmVnbCIsIndyYXBDb2xvclNjYWxlIiwic2NhbGUiLCJjb25zdCIsInRTY2FsZSIsImQzIiwic2NhbGVMaW5lYXIiLCJkb21haW4iLCJyYW5nZSIsInQiLCJyZ2IiLCJyIiwiZyIsImIiLCJjcmVhdGVEcmF3UG9pbnRzIiwicG9pbnRzIiwiZHJhd1BvaW50cyIsImZyYWciLCJ2ZXJ0IiwiYXR0cmlidXRlcyIsInBvc2l0aW9uU3RhcnQiLCJtYXAiLCJkIiwic3giLCJzeSIsInBvc2l0aW9uRW5kIiwidHgiLCJ0eSIsImNvbG9yU3RhcnQiLCJjb2xvckVuZCIsImluZGV4IiwibGVuZ3RoIiwidW5pZm9ybXMiLCJwb2ludFdpZHRoIiwicHJvcCIsInN0YWdlV2lkdGgiLCJzdGFnZUhlaWdodCIsImRlbGF5QnlJbmRleCIsImR1cmF0aW9uIiwiZWxhcHNlZCIsInJlZiIsInJlZiQxIiwidGltZSIsInN0YXJ0VGltZSIsImNvdW50IiwicHJpbWl0aXZlIiwiYW5pbWF0ZSIsImxheW91dCIsImNvbnNvbGUiLCJsb2ciLCJmb3JFYWNoIiwiY29sb3JTY2FsZSIsImNvbG9yU2NhbGVzIiwiY3VycmVudENvbG9yU2NhbGUiLCJpIiwieCIsInkiLCJmcmFtZUxvb3AiLCJmcmFtZSIsImNsZWFyIiwiY29sb3IiLCJkZXB0aCIsIndpZHRoIiwiaGVpZ2h0IiwibWF4RHVyYXRpb24iLCJjYW5jZWwiLCJjdXJyZW50TGF5b3V0IiwibGF5b3V0cyIsIm51bVBvaW50cyIsInBvaW50TWFyZ2luIiwid2luZG93IiwiaW5uZXJXaWR0aCIsImlubmVySGVpZ2h0IiwidG9QaHlsbG90YXhpcyIsInBoeWxsb3RheGlzTGF5b3V0IiwidG9HcmlkIiwiZ3JpZExheW91dCIsInRvU2luZSIsInNpbmVMYXlvdXQiLCJ0b1NwaXJhbCIsInNwaXJhbExheW91dCIsInNjYWxlU2VxdWVudGlhbCIsImludGVycG9sYXRlVmlyaWRpcyIsImludGVycG9sYXRlTWFnbWEiLCJpbnRlcnBvbGF0ZUluZmVybm8iLCJpbnRlcnBvbGF0ZUNvb2wiLCJjcmVhdGVQb2ludHMiLCJleHRlbnNpb25zIiwib25Eb25lIl0sIm1hcHBpbmdzIjoiQUFBQSxRQUFTQSxNQUFLQyxFQUFLQyxHQXVCbEIsUUFBU0MsR0FBZUMsR0FDdkJDLEdBQU1DLEdBQVdDLEdBQUNDLGNBQWNDLFFBQVMsRUFBSSxJQUFFQyxPQUFPLEdBQU8sR0FDN0QsT0FBTyxVQUFBQyxHQUNOTixHQUFNTyxHQUFRTCxHQUFDSyxJQUFJUixFQUFNRSxFQUFTSyxJQUNsQyxRQUFRQyxFQUFJQyxFQUFJLElBQUtELEVBQUlFLEVBQUksSUFBS0YsRUFBSUcsRUFBSSxNQWE1QyxRQUFTQyxHQUFpQkMsR0FDekJaLEdBQU1hLEdBQWFoQixHQUNsQmlCLEtBQU0sa0pBUU5DLEtBNkRDLGlwREFKREMsWUF1REFDLGNBQVdMLEVBQUFNLElBQUEsU0FBQUMsR0FBQSxPQUFBQSxFQUFBQyxHQUFBRCxFQUFBRSxNQXJEVkMsWUFBYVYsRUFBT00sSUFBSSxTQUFBQyxHQUFFLE9BQUlBLEVBQUVJLEdBQUlKLEVBQUVLLE1BdUR0Q0MsV0FBWWIsRUFBT00sSUFBQSxTQUFBQyxHQUFBLE1BQUFBLEdBQUFNLGFBQ25CQyxTQUFRZCxFQUFBTSxJQUFBLFNBQUFDLEdBQUEsTUFBQUEsR0FBQU8sV0FDUkMsTUFBRXpCLEdBQUFHLE1BQUFPLEVBQUFnQixTQW5ESEMsVUF1RENDLFdBQVlqQyxFQUFLa0MsS0FBQSxjQUNqQkMsV0FBV25DLEVBQUVrQyxLQUFNLGNBQ25CRSxZQUFBcEMsRUFBUWtDLEtBQUEsZUFDUkcsYUFBQXJDLEVBQUFrQyxLQUFBLGdCQUNBSSxTQUFBdEMsRUFBQWtDLEtBQVMsWUFHTkssUUFBTyxTQUFBQyxFQUFhQyxNQUFiQyxHQUFTRixFQUFBRSx5Q0FBa0IsR0FBTyxLQUFBQSxFQUFBQyxLQW5EN0NDLE1BQU83QixFQUFPZ0IsT0FDZGMsVUFzREMsVUFuREYsT0FzREU3QixHQWxESCxRQUFTOEIsR0FBUUMsRUFBUWhDLEdBQ3hCaUMsUUFBUUMsSUFBSSw2QkF3RGI5QyxFQUFNK0MsUUFBUyxTQUFBNUIsR0FDZkEsRUFBQUMsR0FBT0QsRUFBQUksR0FDUEosRUFBQUUsR0FBT0YsRUFBQUssR0FDTEwsRUFBQ00sV0FBY04sRUFBQ08sV0FsRGpCa0IsRUFBT2hDLEVBR1BaLElBQU1nRCxHQUFhQyxFQUFZQyxFQUMvQnRDLEdBQU9tQyxRQUFRLFNBQUM1QixFQUFHZ0MsR0FDbEJoQyxFQUFFSSxHQUFLSixFQUFFaUMsRUF1RFpqQyxFQUFLSyxHQUFBTCxFQUFBa0MsRUFyREZsQyxFQUFFTyxTQUFXc0IsRUFBV0csRUFBSXZDLEVBQU9nQixTQUlwQzVCLElBQU1hLEdBQWFGLEVBQWlCQyxFQXdEcEMwQyxHQUFZekQsRUFBQTBELE1BQUEsU0FBQWxCLE1BQUFFLEdBQUFGLEVBQUFFLElBQ1gsUUFBQUMsSUFyRENBLEVBQVlELEdBR2IxQyxFQUFLMkQsT0FFSkMsT0FBUSxFQUFHLEVBQUcsRUFBRyxHQUNqQkMsTUFBTyxJQUdSN0MsR0FDQ2lCLFdBQUFBLEVBQ0FFLFdBQVkyQixFQUNaMUIsWUFBYTJCLEVBQ2J6QixTQUFBQSxFQUNBRCxhQUFBQSxFQUNBTSxVQUFBQSxJQUdHRCxFQUFPQyxFQUFhcUIsRUFBYyxNQUNyQ2hCLFFBQVFDLElBQUkseUNBQ1pRLEVBQVVRLFNBRVZDLEdBQWlCQSxFQUFnQixHQUFLQyxFQUFRcEMsT0FDOUNZLEVBQVksS0FDWlUsR0FBcUJBLEVBQW9CLEdBQUtELEVBQVlyQixPQUMxRGUsRUFBUXFCLEVBQVFELEdBQWdCbkQsTUF2TG5DWixHQWtCSXNELEdBbEJFVyxFQUFZLElBQ1puQyxFQUFlLEVBQ2ZvQyxFQUFnQixFQUNoQlAsRUFBUVEsT0FBT0MsV0FDZlIsRUFBU08sT0FBT0UsWUFDaEJsQyxFQUFXLEtBQ1hELEVBQWUsSUFBTStCLEVBQ3JCSixFQUFjMUIsRUFBV0QsRUFBZStCLEVBRXhDSyxFQUFnQixTQUFBMUQsR0FBQyxNQUFBMkQsbUJBQVczRCxFQUFBa0IsRUFBMEJvQyxFQUFhUCxFQUFBLEVBQVdDLEVBQU8sSUFDckZZLEVBQVMsU0FBQTVELEdBQUMsTUFBQTZELFlBQVE3RCxFQUFHa0IsRUFBbUJvQyxFQUFhUCxJQUNyRGUsRUFBUyxTQUFBOUQsR0FBQyxNQUFBK0QsWUFBUS9ELEVBQUdrQixFQUFtQm9DLEVBQWFQLEVBQUFDLElBQ3JEZ0IsRUFBVyxTQUFBaEUsR0FBQyxNQUFBaUUsY0FBV2pFLEVBQUFrQixFQUFxQm9DLEVBQWFQLEVBQUFDLElBRXpESSxHQUFXTSxFQUFlRSxFQUFRRSxFQUFRRSxHQUM1Q2IsRUFBZ0IsRUFDaEJ2QixFQUFZLEtBY1ZTLEdBQ0wvQyxHQUFHNEUsZ0JBQWdCNUUsR0FBRzZFLG9CQUN0QjdFLEdBQUc0RSxnQkFBZ0I1RSxHQUFHOEUsa0JBQ3RCOUUsR0FBRzRFLGdCQUFnQjVFLEdBQUcrRSxvQkFDdEIvRSxHQUFHNEUsZ0JBQWdCNUUsR0FBR2dGLGtCQUNyQmhFLElBQUlwQixHQUNGb0QsRUFBb0IsRUEwSmxCdEMsRUFBU3VFLGFBQWFsQixFQUFXbkMsRUFBWTZCLEVBQU9DLEVBQzFETyxRQUFPdkQsT0FBU0EsRUFDaEJBLEVBQU9tQyxRQUFRLFNBQUM1QixFQUFHZ0MsR0FDbEJoQyxFQUFFSSxHQUFLb0MsRUFBUSxFQUNmeEMsRUFBRUssR0FBS29DLEVBQVMsRUFDaEJ6QyxFQUFFTyxTQUFXdUIsRUFBWUMsR0FBbUJDLEVBQUl2QyxFQUFPZ0IsVUFHeERlLEVBQVFxQixFQUFRRCxHQUFnQm5ELEdBS2pDZixNQUVFdUYsWUFDRSxxQkFJRkMsT0FBUTFGIiwiZmlsZSI6InNjcmlwdC5qcyIsInNvdXJjZXNDb250ZW50IjpbImZ1bmN0aW9uIG1haW4oZXJyLCByZWdsKSB7XG5cdGNvbnN0IG51bVBvaW50cyA9IDEwMDAwMDtcblx0Y29uc3QgcG9pbnRXaWR0aCA9IDQ7XG5cdGNvbnN0IHBvaW50TWFyZ2luID0gMTtcblx0Y29uc3Qgd2lkdGggPSB3aW5kb3cuaW5uZXJXaWR0aDtcblx0Y29uc3QgaGVpZ2h0ID0gd2luZG93LmlubmVySGVpZ2h0O1xuXHRjb25zdCBkdXJhdGlvbiA9IDE1MDA7XG5cdGNvbnN0IGRlbGF5QnlJbmRleCA9IDUwMCAvIG51bVBvaW50cztcblx0Y29uc3QgbWF4RHVyYXRpb24gPSBkdXJhdGlvbiArIGRlbGF5QnlJbmRleCAqIG51bVBvaW50czsgLy8gaW5jbHVkZSBtYXggZGVsYXkgaW4gaGVyZVxuXG5cdGNvbnN0IHRvUGh5bGxvdGF4aXMgPSAocG9pbnRzKSA9PiBwaHlsbG90YXhpc0xheW91dChwb2ludHMsIHBvaW50V2lkdGggKyBwb2ludE1hcmdpbiwgd2lkdGggLyAyLCBoZWlnaHQgLyAyKTtcblx0Y29uc3QgdG9HcmlkID0gKHBvaW50cykgPT4gZ3JpZExheW91dChwb2ludHMsIHBvaW50V2lkdGggKyBwb2ludE1hcmdpbiwgd2lkdGgpO1xuXHRjb25zdCB0b1NpbmUgPSAocG9pbnRzKSA9PiBzaW5lTGF5b3V0KHBvaW50cywgcG9pbnRXaWR0aCArIHBvaW50TWFyZ2luLCB3aWR0aCwgaGVpZ2h0KTtcblx0Y29uc3QgdG9TcGlyYWwgPSAocG9pbnRzKSA9PiBzcGlyYWxMYXlvdXQocG9pbnRzLCBwb2ludFdpZHRoICsgcG9pbnRNYXJnaW4sIHdpZHRoLCBoZWlnaHQpO1xuXG5cdGNvbnN0IGxheW91dHMgPSBbdG9QaHlsbG90YXhpcywgdG9HcmlkLCB0b1NpbmUsIHRvU3BpcmFsXTtcblx0bGV0IGN1cnJlbnRMYXlvdXQgPSAwO1xuXHRsZXQgc3RhcnRUaW1lID0gbnVsbDsgLy8gaW4gc2Vjb25kc1xuXHQvLyBzdGFydCBhbmltYXRpb24gbG9vcCAobm90ZTogdGltZSBpcyBpbiBzZWNvbmRzKVxuXHRsZXQgZnJhbWVMb29wO1xuXG5cdC8vIHdyYXAgZDMgY29sb3Igc2NhbGVzIHNvIHRoZXkgcHJvZHVjZSB2ZWMzcyB3aXRoIHZhbHVlcyAwLTFcblx0Ly8gYWxzbyBsaW1pdCB0aGUgdCB2YWx1ZSB0byByZW1vdmUgZGFya2VzdCBjb2xvclxuXHRmdW5jdGlvbiB3cmFwQ29sb3JTY2FsZShzY2FsZSkge1xuXHRcdGNvbnN0IHRTY2FsZSA9IGQzLnNjYWxlTGluZWFyKCkuZG9tYWluKFswLCAxXSkucmFuZ2UoWzAuNCwgMV0pO1xuXHRcdHJldHVybiB0ID0+IHtcblx0XHRcdGNvbnN0IHJnYiA9IGQzLnJnYihzY2FsZSh0U2NhbGUodCkpKTtcblx0XHRcdHJldHVybiBbcmdiLnIgLyAyNTUsIHJnYi5nIC8gMjU1LCByZ2IuYiAvIDI1NV07XG5cdFx0fTtcblx0fVxuXG5cdGNvbnN0IGNvbG9yU2NhbGVzID0gW1xuXHRcdGQzLnNjYWxlU2VxdWVudGlhbChkMy5pbnRlcnBvbGF0ZVZpcmlkaXMpLFxuXHRcdGQzLnNjYWxlU2VxdWVudGlhbChkMy5pbnRlcnBvbGF0ZU1hZ21hKSxcblx0XHRkMy5zY2FsZVNlcXVlbnRpYWwoZDMuaW50ZXJwb2xhdGVJbmZlcm5vKSxcblx0XHRkMy5zY2FsZVNlcXVlbnRpYWwoZDMuaW50ZXJwb2xhdGVDb29sKSxcblx0XS5tYXAod3JhcENvbG9yU2NhbGUpO1xuXHRsZXQgY3VycmVudENvbG9yU2NhbGUgPSAwO1xuXG5cdC8vIGZ1bmN0aW9uIHRvIGNvbXBpbGUgYSBkcmF3IHBvaW50cyByZWdsIGZ1bmNcblx0ZnVuY3Rpb24gY3JlYXRlRHJhd1BvaW50cyhwb2ludHMpIHtcblx0XHRjb25zdCBkcmF3UG9pbnRzID0gcmVnbCh7XG5cdFx0XHRmcmFnOiBgXG5cdFx0ICBwcmVjaXNpb24gaGlnaHAgZmxvYXQ7XG5cdFx0XHR2YXJ5aW5nIHZlYzMgZnJhZ0NvbG9yO1xuXHRcdFx0dm9pZCBtYWluKCkge1xuXHRcdFx0XHRnbF9GcmFnQ29sb3IgPSB2ZWM0KGZyYWdDb2xvciwgMSk7XG5cdFx0XHR9XG5cdFx0XHRgLFxuXG5cdFx0XHR2ZXJ0OiBgXG5cdFx0XHRhdHRyaWJ1dGUgdmVjMiBwb3NpdGlvblN0YXJ0O1xuXHRcdFx0YXR0cmlidXRlIHZlYzIgcG9zaXRpb25FbmQ7XG5cdFx0XHRhdHRyaWJ1dGUgZmxvYXQgaW5kZXg7XG5cdFx0XHRhdHRyaWJ1dGUgdmVjMyBjb2xvclN0YXJ0O1xuXHRcdFx0YXR0cmlidXRlIHZlYzMgY29sb3JFbmQ7XG5cblx0XHRcdHZhcnlpbmcgdmVjMyBmcmFnQ29sb3I7XG5cblx0XHRcdHVuaWZvcm0gZmxvYXQgcG9pbnRXaWR0aDtcblx0XHRcdHVuaWZvcm0gZmxvYXQgc3RhZ2VXaWR0aDtcblx0XHRcdHVuaWZvcm0gZmxvYXQgc3RhZ2VIZWlnaHQ7XG5cdFx0XHR1bmlmb3JtIGZsb2F0IGVsYXBzZWQ7XG5cdFx0XHR1bmlmb3JtIGZsb2F0IGR1cmF0aW9uO1xuXHRcdFx0dW5pZm9ybSBmbG9hdCBkZWxheUJ5SW5kZXg7XG5cdFx0XHR2b2lkIG1haW4oKSB7XG5cdFx0XHRcdGdsX1BvaW50U2l6ZSA9IHBvaW50V2lkdGg7XG5cblx0XHRcdFx0ZmxvYXQgZGVsYXkgPSBkZWxheUJ5SW5kZXggKiBpbmRleDtcblx0ICAgICAgZmxvYXQgdDtcblxuXHQgICAgICAvLyBkcmF3aW5nIHdpdGhvdXQgYW5pbWF0aW9uLCBzbyBzaG93IGVuZCBzdGF0ZSBpbW1lZGlhdGVseVxuXHQgICAgICBpZiAoZHVyYXRpb24gPT0gMC4wKSB7XG5cdCAgICAgICAgdCA9IDEuMDtcblxuXHQgICAgICAvLyBzdGlsbCBkZWxheWluZyBiZWZvcmUgYW5pbWF0aW5nXG5cdCAgICAgIH0gZWxzZSBpZiAoZWxhcHNlZCA8IGRlbGF5KSB7XG5cdCAgICAgICAgdCA9IDAuMDtcblx0ICAgICAgfSBlbHNlIHtcblx0ICAgICAgICB0ID0gMi4wICogKChlbGFwc2VkIC0gZGVsYXkpIC8gZHVyYXRpb24pO1xuXG5cdCAgICAgICAgLy8gY3ViaWMgZWFzaW5nIChjdWJpY0luT3V0KSAtLSBub3RlIHRoZXJlIGFyZSBnbHNsaWZ5IHRoaW5ncyBmb3IgdGhpcyB0b1BoeWxsb3RheGlzXG5cdCAgICAgICAgLy8gdGhpcyBpcyBjb3BpZWQgZnJvbSBkMy5cblx0ICAgICAgICB0ID0gKHQgPD0gMS4wID8gdCAqIHQgKiB0IDogKHQgLT0gMi4wKSAqIHQgKiB0ICsgMi4wKSAvIDIuMDtcblxuXHQgICAgICAgIGlmICh0ID4gMS4wKSB7XG5cdCAgICAgICAgICB0ID0gMS4wO1xuXHQgICAgICAgIH1cblx0ICAgICAgfVxuXG5cdFx0XHRcdC8vIGludGVycG9sYXRlIHBvc2l0aW9uXG5cdCAgICAgIGZsb2F0IHggPSBtaXgocG9zaXRpb25TdGFydFswXSwgcG9zaXRpb25FbmRbMF0sIHQpO1xuXHQgICAgICBmbG9hdCB5ID0gbWl4KHBvc2l0aW9uU3RhcnRbMV0sIHBvc2l0aW9uRW5kWzFdLCB0KTtcblxuXHQgICAgICAvLyBpbnRlcnBvbGF0ZSBjb2xvclxuXHQgICAgICBmcmFnQ29sb3IgPSBtaXgoY29sb3JTdGFydCwgY29sb3JFbmQsIHQpO1xuXG5cdFx0XHRcdC8vIHNjYWxlIHRvIG5vcm1hbGl6ZWQgZGV2aWNlIGNvb3JkaW5hdGVzICgtMSwgLTEpIHRvICgxLCAxKVxuXHQgICAgICBnbF9Qb3NpdGlvbiA9IHZlYzQoXG5cdFx0ICAgICAgMi4wICogKCh4IC8gc3RhZ2VXaWR0aCkgLSAwLjUpLFxuXHRcdCAgICAgIC8vIGludmVydCB5IHNpbmNlIHdlIHRoaW5rIFswLDBdIGlzIGJvdHRvbSBsZWZ0IGluIHBpeGVsIHNwYWNlIChuZWVkZWQgZm9yIGQzLnpvb20pXG5cdFx0ICAgICAgLSgyLjAgKiAoKHkgLyBzdGFnZUhlaWdodCkgLSAwLjUpKSxcblx0XHQgICAgICAwLjAsXG5cdFx0ICAgICAgMS4wKTtcblx0XHRcdH1cblx0XHRcdGAsXG5cblx0XHRcdGF0dHJpYnV0ZXM6IHtcblx0XHRcdFx0cG9zaXRpb25TdGFydDogcG9pbnRzLm1hcChkID0+IFtkLnN4LCBkLnN5XSksXG5cdFx0XHRcdHBvc2l0aW9uRW5kOiBwb2ludHMubWFwKGQgPT4gW2QudHgsIGQudHldKSxcblx0XHRcdFx0Y29sb3JTdGFydDogcG9pbnRzLm1hcChkID0+IGQuY29sb3JTdGFydCksXG5cdFx0XHRcdGNvbG9yRW5kOiBwb2ludHMubWFwKGQgPT4gZC5jb2xvckVuZCksXG5cdFx0XHRcdGluZGV4OiBkMy5yYW5nZShwb2ludHMubGVuZ3RoKSxcblx0XHRcdH0sXG5cblx0XHRcdHVuaWZvcm1zOiB7XG5cdFx0XHRcdHBvaW50V2lkdGg6IHJlZ2wucHJvcCgncG9pbnRXaWR0aCcpLFxuXHRcdFx0XHRzdGFnZVdpZHRoOiByZWdsLnByb3AoJ3N0YWdlV2lkdGgnKSxcblx0XHRcdFx0c3RhZ2VIZWlnaHQ6IHJlZ2wucHJvcCgnc3RhZ2VIZWlnaHQnKSxcblx0XHRcdFx0ZGVsYXlCeUluZGV4OiByZWdsLnByb3AoJ2RlbGF5QnlJbmRleCcpLFxuXHQgICAgICBkdXJhdGlvbjogcmVnbC5wcm9wKCdkdXJhdGlvbicpLFxuXG5cdCAgICAgIC8vIHRpbWUgaW4gbWlsbGlzZWNvbmRzIHNpbmNlIHRoZSBwcm9wIHN0YXJ0VGltZSAoaS5lLiB0aW1lIGVsYXBzZWQpXG5cdCAgICAgIGVsYXBzZWQ6ICh7IHRpbWUgfSwgeyBzdGFydFRpbWUgPSAwIH0pID0+ICh0aW1lIC0gc3RhcnRUaW1lKSAqIDEwMDAsXG5cdFx0XHR9LFxuXG5cdFx0XHRjb3VudDogcG9pbnRzLmxlbmd0aCxcblx0XHRcdHByaW1pdGl2ZTogJ3BvaW50cycsXG5cdFx0fSk7XG5cblx0XHRyZXR1cm4gZHJhd1BvaW50cztcblx0fVxuXG5cblx0ZnVuY3Rpb24gYW5pbWF0ZShsYXlvdXQsIHBvaW50cykge1xuXHRcdGNvbnNvbGUubG9nKCdhbmltYXRpbmcgd2l0aCBuZXcgbGF5b3V0Jyk7XG5cdFx0Ly8gbWFrZSBwcmV2aW91cyBlbmQgdGhlIG5ldyBiZWdpbm5pbmdcblx0XHRwb2ludHMuZm9yRWFjaChkID0+IHtcblx0XHRcdGQuc3ggPSBkLnR4O1xuXHRcdFx0ZC5zeSA9IGQudHk7XG5cdFx0XHRkLmNvbG9yU3RhcnQgPSBkLmNvbG9yRW5kO1xuXHRcdH0pO1xuXG5cdFx0Ly8gbGF5b3V0IHBvaW50c1xuXHRcdGxheW91dChwb2ludHMpO1xuXG5cdFx0Ly8gY29weSBsYXlvdXQgeCB5IHRvIGVuZCBwb3NpdGlvbnNcblx0XHRjb25zdCBjb2xvclNjYWxlID0gY29sb3JTY2FsZXNbY3VycmVudENvbG9yU2NhbGVdO1xuXHRcdHBvaW50cy5mb3JFYWNoKChkLCBpKSA9PiB7XG5cdFx0XHRkLnR4ID0gZC54O1xuXHRcdFx0ZC50eSA9IGQueTtcblx0XHRcdGQuY29sb3JFbmQgPSBjb2xvclNjYWxlKGkgLyBwb2ludHMubGVuZ3RoKVxuXHRcdH0pO1xuXG5cdFx0Ly8gY3JlYXRlIHRoZSByZWdsIGZ1bmN0aW9uIHdpdGggdGhlIG5ldyBzdGFydCBhbmQgZW5kIHBvaW50c1xuXHRcdGNvbnN0IGRyYXdQb2ludHMgPSBjcmVhdGVEcmF3UG9pbnRzKHBvaW50cyk7XG5cblx0XHRmcmFtZUxvb3AgPSByZWdsLmZyYW1lKCh7IHRpbWUgfSkgPT4ge1xuXHRcdFx0aWYgKHN0YXJ0VGltZSA9PT0gbnVsbCkge1xuXHRcdFx0XHRzdGFydFRpbWUgPSB0aW1lO1xuXHRcdFx0fVxuXG5cdFx0XHRyZWdsLmNsZWFyKHtcblx0XHRcdFx0Ly8gYmFja2dyb3VuZCBjb2xvciAoYmxhY2spXG5cdFx0XHRcdGNvbG9yOiBbMCwgMCwgMCwgMV0sXG5cdFx0XHRcdGRlcHRoOiAxLFxuXHRcdFx0fSk7XG5cblx0XHRcdGRyYXdQb2ludHMoe1xuXHRcdFx0XHRwb2ludFdpZHRoLFxuXHRcdFx0XHRzdGFnZVdpZHRoOiB3aWR0aCxcblx0XHRcdFx0c3RhZ2VIZWlnaHQ6IGhlaWdodCxcblx0XHRcdFx0ZHVyYXRpb24sXG5cdFx0XHRcdGRlbGF5QnlJbmRleCxcblx0XHRcdFx0c3RhcnRUaW1lLFxuXHRcdFx0fSk7XG5cblx0XHRcdGlmICh0aW1lIC0gc3RhcnRUaW1lID4gKG1heER1cmF0aW9uIC8gMTAwMCkpIHtcblx0XHRcdFx0Y29uc29sZS5sb2coJ2RvbmUgYW5pbWF0aW5nLCBtb3ZpbmcgdG8gbmV4dCBsYXlvdXQnKTtcblx0XHRcdFx0ZnJhbWVMb29wLmNhbmNlbCgpO1xuXG5cdFx0XHRcdGN1cnJlbnRMYXlvdXQgPSAoY3VycmVudExheW91dCArIDEpICUgbGF5b3V0cy5sZW5ndGg7XG5cdFx0XHRcdHN0YXJ0VGltZSA9IG51bGw7XG5cdFx0XHRcdGN1cnJlbnRDb2xvclNjYWxlID0gKGN1cnJlbnRDb2xvclNjYWxlICsgMSkgJSBjb2xvclNjYWxlcy5sZW5ndGg7XG5cdFx0XHRcdGFuaW1hdGUobGF5b3V0c1tjdXJyZW50TGF5b3V0XSwgcG9pbnRzKTtcblx0XHRcdH1cblx0XHR9KTtcblx0fVxuXG5cblx0Ly8gY3JlYXRlIGluaXRpYWwgc2V0IG9mIHBvaW50c1xuXHRjb25zdCBwb2ludHMgPSBjcmVhdGVQb2ludHMobnVtUG9pbnRzLCBwb2ludFdpZHRoLCB3aWR0aCwgaGVpZ2h0KTtcblx0d2luZG93LnBvaW50cyA9IHBvaW50cztcblx0cG9pbnRzLmZvckVhY2goKGQsIGkpID0+IHtcblx0XHRkLnR4ID0gd2lkdGggLyAyO1xuXHRcdGQudHkgPSBoZWlnaHQgLyAyO1xuXHRcdGQuY29sb3JFbmQgPSBjb2xvclNjYWxlc1tjdXJyZW50Q29sb3JTY2FsZV0oaSAvIHBvaW50cy5sZW5ndGgpO1xuXHR9KTtcblxuXHRhbmltYXRlKGxheW91dHNbY3VycmVudExheW91dF0sIHBvaW50cyk7XG59XG5cblxuLy8gaW5pdGlhbGl6ZSByZWdsXG5yZWdsKHtcblx0Ly8gZW5hYmxlIHRoZSB0ZXh0dXJlIGZsb2F0IGV4dGVuc2lvbiB0byBzdG9yZSBwb3NpdGlvbnMgaW4gYnVmZmVyc1xuICBleHRlbnNpb25zOiBbXG4gICAgJ09FU190ZXh0dXJlX2Zsb2F0JyxcbiAgXSxcblxuICAvLyBjYWxsYmFjayB3aGVuIHJlZ2wgaXMgaW5pdGlhbGl6ZWRcbiAgb25Eb25lOiBtYWluXG59KTtcbiJdfQ==
